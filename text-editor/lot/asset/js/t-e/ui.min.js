/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.3.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Le(e){return e.toLowerCase()}function Se(e){return L(e)?$(e).split(/\s+/):e}function ze(e){return E(e)?e.join(" "):e}function De(e,t){return-1!==e.indexOf(t)}function Me(e){return Object.keys(e)}function Ie(e){return e.length}function Re(e){return Ie(Me(e))}function je(e,t,n){return O(e)?O(t)?(O(v[e])||(v[e]={}),O(n)||(n=Re(v[e])),v[e][n]=t,o):v[e]:v}function Fe(e,t){return O(e)?O(t)&&O(v[e])?(delete v[e][t],o):(v[e]={},o):(v={},o)}function He(e,t,n){if(!O(v[e]))return v[e]={},o;if(O(n))O(v[e][n])&&v[e][n].apply(o,t);else for(A in v[e])v[e][A].apply(o,t);return o}function Ce(e,t,n){if(E(t))for(A in t)Ce(e,A,t[A]);else e[(null===n?"remove":"set")+"Attribute"](t,n)}function Ue(e,n,r){if(!n){for(t={},A=0,Y=e.attributes,W=Ie(Y);W>A;++A)X=Y[A],t[X.name]=X.value;return Re(t)?t:O(r)?r:{}}if(L(n))return Ue(e,[n],[O(r)?r:""])[0];t=[];for(A in n)A=n[A],A=e.getAttribute(A)||"",t.push(A);return Ie(t)?t:O(r)?r:[]}function Be(e,t){if(E(t))for(A in t)Be(e,t[A]);else if(O(t))e.removeAttribute(t);else for(Be(e,"class"),A=0,Y=e.attributes,W=Ie(Y);W>A;++A)Y[A]&&Be(e,Y[A].name)}function Ne(e,t,n){if(E(t))for(A in t)Ne(e,A,t[A]);else Ce(e,"data-"+t,n)}function Ae(e,n,r){if(!n){for(t={},A=0,Y=e.attributes,W=Ie(Y);W>A;++A)X=Y[A],"data-"===X.name.slice(0,5)&&(t[X.name]=X.value);return Re(t)?t:O(r)?r:{}}if(L(n))return Ae(e,[n],[O(r)?r:""])[0];t=[];for(A in n)A=n[A],A=Ue(e,"data-"+A),t.push(A);return Ie(t)?t:O(r)?r:[]}function Ye(e,t){if(E(t))for(A in t)Be(e,"data-"+t[A]);else if(O(t))Be(e,"data-"+t);else for(A=0,Y=e.attributes,W=Ie(Y);W>A;++A)Y[A]&&"data-"===Y[A].name.slice(0,5)&&Be(e,Y[A].name)}function We(e){return e&&e.preventDefault(),!1}function Xe(e,t,n){if(t){for(e=Se(e),A=0,Y=Ie(e);Y>A;++A)t.addEventListener(e[A],n,!1),je("on:"+e[A],n,at(t));return o}}function Ke(e,t,n){if(t){for(e=Se(e),A=0,Y=Ie(e);Y>A;++A)t.removeEventListener(e[A],n,!1),Fe("on:"+e[A],at(t));return x(t)&&t.id.split(":")[0]===Mt+"-dom"&&Be(t,"id"),o}}function Pe(e,t,n){e=Se(e);var i,r="createEvent"in f;for(A=0,Y=Ie(e);Y>A;++A)r?(i=f.createEvent("HTMLEvents"),i.data=n,i.initEvent(e[A],!0,!1),t.dispatchEvent(i)):He("on:"+e[A],n,at(t));return o}function Ze(e,t,n){for(A=0,Y=Ie(t),W;Y>A;++A)W=t[A],e=e.replace(q(W)?W:g(d(W),"g"),n&&n[A]||"");return e}function Qe(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,O(t[n])?t[n]:e})}function Ge(e){return $(Ze(Le(e),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Je(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY,i=Ve(e);return{x:n-i.l,y:r-i.t}}function Ve(e){for(X=e.offsetLeft,V=e.offsetTop;e=e.offsetParent;)X+=e.offsetLeft,V+=e.offsetTop;return{l:X,t:V}}function et(e){return e===a?{w:e.innerWidth,h:e.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function tt(e,t){for(;(e=pt(e))&&e!==t;);return e}function nt(e,t){t=Se(t);for(A in t)e.classList.add(t[A])}function rt(e,n,r){if(!n)return t=Se(e.className),Ie(t)?t:O(r)?r:[];if(L(n))return rt(e,[n],[O(r)?r:""])[0];t=[];for(A in n)A=n[A],e.classList.contains(A)&&t.push(A);return Ie(t)?t:O(r)?r:[]}function it(e,t){if(O(t)){t=Se(t);for(A in t)e.classList.remove(t[A])}else Be(e,"class")}function lt(e,t){t=Se(t);for(A in t)e.classList.toggle(t[A])}function st(e,t,n){if(e=e||"div",e=L(e)?f.createElement(e):e,E(n)){t||(O(n.html)?(t=n.html,delete n.html):O(n.text)&&(t=n.text,delete n.text));for(A in n)if(te=n[A],"classes"===A)nt(e,te);else if("data"===A)for(Y in te)te=te[Y],null===te?Ye(e,Y):Ne(e,Y,te);else"css"===A?L(te)?Ce(e,"style",te):null===te?Be(e,"style"):u(e,te):w(te)?e[A]=te:null===te?Be(e,A):Ce(e,A,_(te)?te.join(" "):""+te)}if(x(t))Tt(e,t);else if(E(t))for(A in t)te=t[A],x(te)?Tt(e,te):te!==!1&&ft(e,te);else O(t)&&t!==!1&&ft(e,t);return e}function at(e){var t=e.id;return t||(t=Mt+"-dom:"+Math.floor(Date.now()*Math.random()),e.id=t),t}function ft(e,t){e.innerHTML=t}function ot(e,t){return e.innerHTML||(O(t)?t:"")}function ct(e,t){if((!O(t)||t)&&(F=dt(e)))for(A=0,Y=Ie(F);Y>A;++A)ct(F[A]);ft(e,"")}function ut(e){return Array.prototype.slice.call(e)}function pt(e){return e&&e.parentNode}function dt(e){return e&&ut(e.children||[])}function ht(e,t){return O(t)?L(t)?e.closest(t):tt(e,t):pt(e)}function gt(e){return e&&e.nextElementSibling}function mt(e){return e&&e.previousElementSibling}function bt(e){for(A=0;e=mt(e);)++A;return A}function $t(e,t){return e&&L(t)?Le(e.nodeName)===Le(t):e&&w(t)?e===t(e):e===t}function vt(e,t){return(t=O(t)?t:f)?L(e)?/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(e)?"#"===e[0]&&(e=t.getElementById(e.slice(1)))?[e]:"."===e[0]&&(e=t.getElementsByClassName(e.slice(1)))||(e=t.getElementsByTagName(e))?ut(e):[]:ut(t.querySelectorAll(e)):kt(e)?[e]:[]:[]}function kt(e,t){var n=pt(e);return 1===Ie(arguments)?n||!1:e&&n===e?n:!1}function yt(e,t){Z=pt(e),Z&&Z.insertBefore(t,e)}function xt(e,t){Z=pt(e),Z&&Z.insertBefore(t,gt(e))}function _t(e,t){F=e.firstChild,F?yt(F,t):Tt(e,t)}function wt(e,t){Tt(e,t)}function Tt(e,t){e.appendChild(t)}function Et(e,t){var n=pt(e);if(n){if(!O(t)||t)for(F=e.firstChild;F;)Et(F);n.removeChild(e)}}function qt(e,t){return e.cloneNode(O(t)?!!t:!0)}function Ot(e,t){return pt(e).replaceChild(t,e),t}function Lt(e){ct(st(e,!1,{style:""})),Et(e)}function St(e,t,n){return st(t,n,{"class":e})}function ln(e){return!e||O(e.active)&&!e.active}function sn(e,t,n){return w(e)&&(e={click:e}),L(e.click)&&(e.click=(n[e.click]||{}).click),e.title=It[t]||"",O(e.attributes)||(e.attributes={}),n[t]&&(n[t]=e),e}function an(e){zt.exit(0,0,0);var t=Ae(this,"tool-id"),n=zt.tools,r=n[t];return zt.drop.target=e.currentTarget||e.target,!ln(r)&&w(Y=r.click)&&(Y=Y(e,o,t),He("on:change",[e,o,t]),Y===!1)?We(e):(o.select(),We(e))}function fn(e){if(V=this,(W=e.TE.key)(["escape","f10"]))zt.exit(1);else if(W("enter")||W("down")&&Ae(V,"ui-drop"))zt.drop.target=V,Pe(ae,V,[e]);else if(W("right")&&(X=gt(V))){for(;!$t(X,"a")&&X;)X=gt(X);X&&X.focus()}else if(W("left")&&(X=mt(V))){for(;!$t(X,"a")&&X;)X=mt(X);X&&X.focus()}return We(e)}function cn(){ct(Yt,0);var i,l,s,a,f,c,u,e=zt.tools,t=Se(M.tools),n=Mt+"-button",r=Mt+"-separator";M.tools=t;for(c in t)u=t[c],l=e[u],(l||l==={})&&(l=sn(l,u,e),s=l.i||u,"|"===s||De(s,"<")||(s=Ge(s)),a="|"!==s,f=Ge(u).replace(/[\/\s]/g,"-"),nn=St(a?n+" "+n+"-"+f:r+" "+r+"-"+c,a?"a":"span"),a?(nn=l.target||nn,i=n+":"+f,Ce(nn,{href:qe,id:i,tabindex:-1}),Ne(nn,"tool-id",u),s=De(s,"<")?s:zt.i(f,s),ln(l)?nt(nn,"x"):it(nn,"x"),l.on?nt(nn,"on"):it(nn,"on"),l.text&&(s=Qe('<span class="'+Mt+'-text">'+l.text+"</span>",[s]),nt(nn,"text")),ft(nn,s),st(nn,!1,l.attributes),!l.attributes.title&&(Y=l.title)&&(nn.title=E(Y)?Y[0]+(Y[1]?" ("+Y[1]+")":""):Y),Xe(ae,nn,an),Xe(pe,nn,fn)):nn.id=r+":"+c,l.target=nn,(f=Ae(nn,on))&&zt.menu.set(u,f),Tt(Yt,nn));He("update.tools",[o])}function un(){zt.keys=function(){var n,e=Me(zt.keys).sort().reverse(),t={};for(A=0,Y=Ie(e);Y>A;++A)n=e[A],t[n]=zt.keys[n];return t}(),dn(),He("update.keys",[o])}function pn(e){function h(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=o.$(),r=n.before,i=n.after,l=r.slice(-1),s=i[0],a=n.length,f=zt.keys,c=TE.keys_a,u={control:0,shift:0,option:"alt",meta:0},p=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(A in u)e.TE[A]()&&(I[u[A]||A]=1);P=e.TE.key(),I[P]=1,t=Re(I),b(function(){o.record()});for(A in f){W=h(A),F=0;for(Y in W)Y=W[Y],I[c[Y]||Y]&&++F;if(W=Ie(W),F===W&&t===W&&(L(f[A])&&(f[A]=zt.tools[f[A]].click),X=w(f[A])?f[A](e,o):0,X===!1))return We(e)}if(ve)for(A in ve)if(K=ve[A],K!==!1){if(P===K&&s===K)return"\\"===l?(o.insert(P,0),We(e)):(o.select(n.end+1),We(e));if(A===P)return o.wrap(A,K),We(e);if(l===A&&s===K){if("backspace"===P&&r.slice(-2)!=="\\"+A)return o.unwrap(A,K),We(e);if(ke&&"enter"===P&&A!==K&&!a)return o.tidy("\n"+p+xe,"\n"+p).scroll(1),We(e)}}if(ke&&!a){if("backspace"===P&&g(d(xe)+"$").test(r))return o.outdent(xe),We(e);if("enter"===P&&g("(^|\\n)("+d(xe)+")+.*$").test(r))return o.insert("\n"+p,0,1).scroll(1),We(e)}}function dn(e){e&&e.TE&&e.TE.key?delete I[e.TE.key()]:I={}}function $n(e){return hn=Ht,J=et(At),We(e)}function vn(e){hn===Ht&&u(Wt,{height:Je(Nt,e).y-J.h+Oe})}function kn(){hn=0}function yn(){zt.exit(1)}function xn(){t=et(Zt),ne=t.w,N=t.h,t=et(Pt),gn=t.w,mn=t.h}function _n(e,t){return t&&He("exit.modal."+t,[o]),Pe(ae,Pt,[e]),We(e)}function wn(e){hn=e.target,t=Je(Zt,e),re=t.x,ie=t.y,xn()}function Tn(e){var n=bn.header,r=bn.sizer;hn===n||tt(hn,n)===n?(t=Je(Nt,e),X=t.x-re,V=t.y-ie,u(Zt,{left:(ne>gn?X:p(X,0,gn-ne))+Oe,top:(N>mn?V:p(V,0,mn-N))+Oe})):hn===r&&(t=Je(Zt,e),J=et(r),u(Zt,{width:t.x+J.w/4+Oe,height:t.y+J.h/4+Oe}))}function En(){hn=0}function qn(e,t,n){return{header:e,body:t,footer:n}}function On(e){R=zt.drop.target,j=Qt,F=e&&e.target||0,(!F||F!==R&&tt(F,R)!==R)&&(zt.drop.target=0,zt.exit(F===Wt))}var R,j,F,U,N,A,Y,W,X,K,P,t,Z,G,J,V,ee,te,ne,re,ie,n="⌘",r="…",i="⌥",l="⇥",s="⇧",a=window,f=document,o=new TE(e),c=o._,u=c.css,p=c.edge,d=c.x,h=c.extend,g=c.pattern,m=c.timer.reset,b=c.timer.set,$=c.trim,v={},k=function(){},y=TE.is,x=y.e,_=y.a,w=y.f,T=y.i,E=y.o,q=y.r,O=function(e){return!y.x(e)},L=y.s,S=f.documentElement,D=(f.head,f.body),M=h({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools",i+"+F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",l],outdent:["Outdent",s+"+"+l]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+r},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%2"}},t),I={},se="blur",ae="click",pe="keydown",de="keyup",he="touchstart mousedown",ge="touchmove mousemove",me="touchend mouseup",$e="orientationchange resize",ve=M.auto_close,ke=M.auto_tab,ye=M.languages,xe=M.tab,we=(M.union[1][1],M.union[1][0]),Te=M.union[0][1],Ee=M.union[0][0],qe="javascript:;",Oe="px",zt=o.ui={};o.tidy=function(e,t){var n=o.$(),r=$(n.before)?e:"",i=$(n.after)?O(t)?t:e:"";return o.trim(r,i)},o.i=function(){return $(o.replace(/\s+/g," "))},o.format=function(e,t,n,r){E(e)||(e=[e]),O(n)||(n=" "),O(r)||(r="");var i=o.h,l=o[0]().$(),s=e[0].split(g("("+Te[3]+")+"))[0],a=(e[0]?we[0]+e[0]+we[1]:"")+r,f=r+(e[0]?we[0]+we[2]+(e[1]||s)+we[1]:""),c=d(e[0]?we[0]+s+we[1]:""),u=d(f),p=g("^"+c+"([\\s\\S]*?)"+u+"$"),h=g(c+"$"),m=g("^"+u),b=l.before,$=l.after;return l.length?n=!1:o.insert(ye.placeholders[""]),o.toggle(t?!p.test(l.value):!h.test(b)&&!m.test($),[function(e){e.unwrap(a,f,1).tidy(g(Ee[0]+"[^"+Ee[0]+Ee[1]+Ee[2]+"]+?"+Ee[1]+"$").test(b)?"":n,g("^"+Ee[0]+Ee[2]+"[^"+Ee[0]+Ee[1]+"]+?"+Ee[1]).test($)?"":n).wrap(a,f,t)},function(e){e.unwrap(a,f,t)}])[i]()};var nn,Dt=M.classes,Mt=Dt[""],It=ye.tools,Rt=ye.buttons,jt=ye.labels,Ft=Mt+"-textarea "+Mt+"-content block",Ht=St(Mt+"-sizer s"),Ct=St(Mt+"-sizer se"),Ut=St(Mt),Bt=St(Mt+"-header"),Nt=St(Mt+"-body"),At=St(Mt+"-footer"),Yt=St(Mt+"-tool"),Wt=st(e,!1,M.attributes),Xt=St(Mt+"-description"),Kt=st(),Pt=st(),Zt=st(),Qt=st(),Gt=st(),Jt=st(),Vt=St("left","span"),en=St("right","span"),tn=0;zt.i=function(e,t,n){return e=Ge(e).replace(/[\/\s]/g,"-"),J=Qe(Dt.i,[e,t||e]),n?(it(n),nt(n,J),n):'<i class="'+J+'"></i>'},O(M.suffix)||(M.suffix=we[1]);var on="ui-drop-data",hn=0,re=0,ie=0,ne=0,N=0,gn=0,mn=0,bn={};o.create=function(e,t){if(o.is.create)return o;o.is.create=!0,E(e)&&(M=h(M,e));var n=kt(Wt);return nt(Ut,Mt+"-is-can-update"),nt(Ut,Mt+"-is-can-copy"),nt(Wt,Ft),n&&$t(n,"p")?(yt(n,Ut),tn=n,Et(n,!1)):yt(Wt,Ut),Ut.dir=M.direction,Tt(Ut,Bt),Tt(Ut,Nt),Tt(Ut,At),Tt(Nt,Wt),M.tools&&(Tt(Bt,Yt),Tt(At,Xt),Tt(Xt,Vt),Tt(Xt,en)),Xe(pe,Wt,pn),Xe(de+" "+se,Wt,dn),P=Mt+"-is-can-resize",M.resize?(Tt(Ut,Ht),nt(Ut,P),Xe(he,Ht,$n),Xe(ge,f,vn),Xe(me,f,kn)):it(Ut,P),cn(),un(),0!==t?He("create",[o]):o},o.update=function(e,t){return o.is.create&&o.destroy(0),(0!==t?He("update",[o]):o).create(e,0)},o.destroy=function(e){return o.is.create?(o.is.create=!1,zt.exit(0,0,0),it(Wt,Ft),M.tools=ze(M.tools),M.keys&&(Ke(pe,Wt,pn),Ke(de,Wt,dn)),M.resize&&(Ke(he,Ht,$n),Ke(ge,f,vn),Ke(me,f,kn)),tn?(yt(Ut,tn),Tt(tn,Wt),tn=0):yt(Ut,Wt),Lt(Ut),0!==e?He("destroy",[o]):o):o},o.enable=function(e){return Wt.disabled=Wt.readOnly=!1,nt(Ut,Mt+"-is-can-update"),nt(Ut,Mt+"-is-can-copy"),0!==e?He("enable",[o]):o},o.disable=function(e){return Wt.disabled=!0,it(Ut,Mt+"-is-can-update"),it(Ut,Mt+"-is-can-copy"),0!==e?He("disable",[o]):o},o.freeze=function(e){return Wt.disabled=!1,Wt.readOnly=!0,it(Ut,Mt+"-is-can-update"),nt(Ut,Mt+"-is-can-copy"),0!==e?He("freeze",[o]):o},zt.exit=function(e,t,n){if(U={panel:function(){Lt(Kt)},overlay:function(){Ke(ae,Pt,yn),Lt(Pt)},modal:function(){Ke(ae+" "+pe,bn.x,_n),Ke(he,Nt,wn),Ke(ge,Nt,Tn),Ke(me,f,En),Lt(Zt)},drop:function(){Ke(ae,f,On),Ke($e,a,On),Lt(Qt)},bubble:function(){Lt(Gt)}},dn(),t)if(E(t))for(A in t)A=t[A],U[A]&&U[A](),0!==n&&He("exit."+A,[o]);else U[t]&&U[t](),0!==n&&He("exit."+A,[o]);else for(A in U)U[A]();return e&&o.select(),0!==n&&He("exit",[o]),o},zt.panel=function(e,t,n,r){function i(e){return Ke(ae+" "+pe,re,i),zt.panel.exit(1),We(e)}return zt.exit(0,0,0),X=Ge(e),V=0,r&&(X+=" "+X+"--"+Ge(r)),E(t)&&!x(t)&&(V=St(Mt+"-panel-header "+X,0,t.header),t=t.body),ee=St(Mt+"-panel-body "+X,0,St(Mt+"-panel-content "+X,0,w(t)?"":t)),w(t)&&t(ee),re=st("a",!1,{href:qe,"class":Mt+"-a "+Mt+"-x "+X}),re.title=Rt.close,st(Kt,!1,{"class":Mt+"-panel "+X}),Xe(ae+" "+pe,re,i),ct(Kt,0),V&&Tt(Kt,V),Tt(Nt,st(Kt,[ee,re])),w(n)?n(Kt):L(n)&&st(Kt,n),R=[o,Kt],r&&He("enter.panel."+e+":"+r,R),He("enter.panel."+e,R),He("enter.panel",R),He("enter",R),re.focus(),o},zt.panel.fit=function(){},zt.overlay=function(e,t,n,r){return zt.exit(0,0,0),X=Ge(e),r&&(X+=" "+X+"--"+Ge(r)),Tt(Nt,st(Pt,!1,{"class":Mt+"-overlay "+X})),t&&Xe(ae,Pt,yn),w(n)?n(Pt):L(n)&&st(Pt,n),R=[o,Pt],r&&He("enter.overlay."+e+":"+r,R),He("enter.overlay."+e,R),He("enter.overlay",R),He("enter",R),o},zt.overlay.fit=function(){},zt.message=function(e,t,n,r,i){function s(e){return Ke(ae+" "+pe,re,s),m(l),zt.overlay.exit(1),We(e)}var l;return X=Ge(e),i&&(X+=" "+X+"--"+Ge(i)),re=st("a",!1,{href:qe,"class":Mt+"-a "+Mt+"-x "+X}),re.title=Rt.close,st(Jt,w(t)?t(Jt):t,{"class":Mt+"-message "+X}),Xe(ae+" "+pe,re,s),zt.overlay("message message-"+X,0,function(e){Tt(Jt,re),n&&(l=b(function(){s()},n)),Tt(e,Jt)},i),w(r)?r(Jt):L(r)&&st(Jt,r),o},zt.modal=function(){var a,c,e=arguments,t=e[0],n=e[1],r=e[2],i=e[3],l=Mt+"-modal",s=n.footer;if(E(t)&&(t="default",n=e[0],r=e[1],i=e[2]),zt.overlay(t,1,0,i).blur(),X=Ge(t),i&&(X+=" "+X+"--"+Ge(i)),st(Zt,!1,{"class":l+" "+X}),O(n.body)&&(n.body=st("div",n.body,{"class":l+"-content "+X})),O(s)&&E(s)&&!x(s)){c=[];for(A in s)Y=s[A],x(Y)?c.push(Y):(Y=sn(Y,A,s),W=A.text||Rt[A]||A,a=st("button",W,h({name:"y["+A+"]",type:"button","class":Mt+"-button",data:{"button-id":A}},Y.attributes)),Xe(ae,a,function(e){return W=s[Ae(this,"button-id")].click(e,o),W===!1?We(e):void 0}),c.push(a));n.footer=c}for(A in n)l[1]=A,bn[A]=St(l+"-"+Qe(A,l)+" "+X,0,n[A]);return bn.x=st("a",!1,{href:qe,"class":Mt+"-a "+Mt+"-x "+X}),bn.sizer=Ct,ct(Zt,0),bn.x.title=Rt.close,Tt(Nt,st(Zt,bn,{style:""})),zt.modal.fit(),xt(Zt,Pt),Xe(ae+" "+pe,bn.x,_n),Xe(he,bn.header,We),Xe(he,bn.sizer,We),Xe(he,Nt,wn),Xe(ge,Nt,Tn),Xe(me,f,En),w(r)&&r(bn),R=[o,Zt,bn],i&&He("enter.modal."+t+":"+i,R),He("enter.modal."+t,R),He("enter.modal",R),He("enter",R),bn.x.focus(),o},zt.modal.fit=function(e){return xn(),X=gn/2-ne/2,V=mn/2-N/2,E(e)?(O(e[0])&&(X=e[0]),O(e[1])&&(V=e[1])):(X=p(X,0),V=p(V,0)),u(Zt,{left:X+Oe,top:V+Oe,"min-width":ne+Oe,"min-height":N+Oe,visibility:"visible"}),R=[o,Zt,bn],He("fit.modal",R),He("fit",R),o};var Ln={"class":Mt+"-button",name:"y"};return zt.alert=function(e,t,n,r,i){var l=st("button",Rt.okay,Ln),s="alert";return n=n||k,E(e)&&(s+=":"+e[0],e=e[1]||e[0]),Xe(ae,l,function(e){return n(e,o),_n(e,s+".y")}),Xe(pe,l,function(e){var t=e.TE.key;return t(["enter","escape"])&&Pe(ae,l,[e]),We(e)}),zt.modal(s,qn(e,t,l),r,i),l.focus(),o},zt.confirm=function(e,t,n,r,i,l){function u(e){return w(n)&&n(e,o),_n(e,f+".y")}function p(e){return w(r)&&r(e,o),_n(e,f+".n")}var c,s=st("button",Rt.okay,Ln),a=st("button",Rt.cancel,Ln),f="confirm";return a.name="n",Xe(ae,s,u),Xe(ae,a,p),Xe(pe,s,function(e){return c=e.TE.key,c("right")?a.focus():c("enter")?u(e):c("escape")&&_n(e,f+".y"),We(e)}),Xe(pe,a,function(e){return c=e.TE.key,c("left")?s.focus():c("enter")?p(e):c("escape")&&_n(e,f+".n"),We(e)}),zt.modal(f,qn(e,t,[s,a]),i,l),a.focus(),o},zt.prompt=function(e,t,n,r,i,l,s){function m(){c.focus(),"placeholder"in c&&c.select()}function b(e){return d=c.value,w(n)&&!n(d)?m():!n||$(d)&&d!==t?(_n(e,u+".y"),r(e,o,d!==t?d:"",t)):m(),We(e)}function v(e){return _n(e,u+".n")}var d,h,g,a=st("button",Rt.okay,Ln),f=st("button",Rt.cancel,Ln),c=st("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":Mt+"-input block"}),u="prompt",p=[];if(i=i||0,1===i)c=st("textarea",t,{placeholder:t.split("\n")[0],"class":Mt+"-textarea block",spellcheck:"false"});else if(2===i){for(A in t)p.push(st("option",t[A],{value:A,selected:A===n||null}));c=st("select",p,{"class":Mt+"-select block"})}return r=r||k,c.name="data",f.name="n",Xe(pe,c,function(e){return h=e.TE.key,g=e.TE.control,h("enter")&&0===i||g("enter")?b(e):h("escape")||h("back")&&!this.value?v(e):h("down")&&0===i||h("enter")&&2===i||g("down")?(a.focus(),We(e)):void 0}),Xe(pe,a,function(e){return h=e.TE.key,h("enter")?b(e):h("escape")?v(e):h("up")?c.focus():h("right")&&f.focus(),We(e)}),Xe(pe,f,function(e){return h=e.TE.key,h(["enter","escape"])?v(e):h("up")?c.focus():h("left")&&a.focus(),We(e)}),Xe(ae,a,b),Xe(ae,f,v),zt.modal(u,qn(e,c,[a,f]),l,s),m(),o},zt.drop=function(){zt.exit(0,0,0);var e=arguments,t=e[0],n=e[1],r=e[2];return 1===Ie(e)&&(t="default",n=e[0],r=e[1]),X=Ge(t),ct(Qt,0),Tt(D,st(Qt,!1,{"class":Mt+"-drop "+X})),w(n)?n(Qt):st(Qt,n),zt.drop.fit(),r===!1||(Xe(ae,f,On),Xe($e,a,On)),R=[o,Qt],He("enter.drop."+t,R),He("enter.drop",R),o},zt.drop.fit=function(e){return R=et(S),j=et(Qt),F=zt.drop.target,X=R.w/2-j.w/2,V=R.h/2-j.h/2,!O(e)&&F&&(t=Ve(F),X=t.l,V=t.t+et(F).h),E(e)?(O(e[0])&&(X=e[0]),O(e[1])&&(V=e[1])):(X=p(X,0,R.w-j.w),V=p(V,0,Math.max(R.h,et(a).h)-j.h)),u(Qt,{left:X+Oe,top:V+Oe,visibility:"visible"}),R=[o,Qt],He("fit.drop",R),He("fit",R),o},zt.menu=function(e,n,r,i){var a,l=zt.tools,s=0;if(n===!1)return zt.tool(e,n);for(i in r)ne="%"===i[0],a=r[i],a=L(a)&&!ne?l[a]:a,a&&(a=sn(a,i,l),r[i]=a);return zt.tool(e,{i:E(n)?n[0]:0,text:E(n)?n[1]||0:n&&r[n]&&r[n].text||n,click:function(f){var c=zt.drop.target=l[e].target;return zt.drop("menu menu-"+Ge(e),function(f){function u(s){return V=this,t=Ae(V,"tool-id"),K=r[t],K=L(K)?l[K]:K||{},P=ot(V),!ln(K)&&w(i=K.click)&&(i=i(s,o),K.i&&(l[e].i=K.i),zt.menu.set(e,E(K.text)?[K.text[0],t]:E(n)?[n[0],t]:t),i===!1)?(o.select(),We(s)):(o.select(),We(s))}function p(e){if(V=this,(W=e.TE.key)("escape"))zt.exit(1);else if(W("enter"))Pe(ae,V,[e]);else if(W("f10")&&c)c.focus();else if(W("down")&&(X=gt(V))){for(;!$t(X,"a")&&X;)X=gt(X);X&&X.focus()}else if(W("up")&&(X=mt(V))){for(;!$t(X,"a")&&X;)X=mt(X);!X&&c?(zt.exit(),c.focus()):X&&X.focus()}else W("up")&&c&&(zt.exit(),c.focus());return We(e)}for(i in r)if(a=r[i],ne="%"===i[0],a){var d={href:ne?null:qe,"class":Mt+"-"+(ne?"label":"button")};ne?Y=jt[e]&&jt[e][+i.slice(1)-1]||i:(d.data={},d.data["tool-id"]=i,Y=It[i]||i),G=a.text,G=E(G)?G[1]||"":G,Y=E(Y)?Y[0]:Y,J=st(ne?"span":"a","<span>"+(ne?Y||"%"+s:G||Y)+"</span>",h(d,a.attributes||{})),nt(J,"menu-"+Ge(i).replace(/[\/\s]/g,"-")),!d.title&&(V=a.title)&&(J.title=E(V)?V[0]+(V[1]?" ("+V[1]+")":""):V),ne?Ce(J,{id:Mt+"-label:"+s}):(ln(a)?nt(J,"x"):it(J,"x"),a.on?nt(J,"on"):it(J,"on"),Xe(ae,J,u),Xe(pe,J,p)),Tt(f,J),++s}b(function(){(vt('[data-tool-id="'+Ae(c,on)+'"]',f)[0]||vt("a",f)[0]).focus()},1)}),!1}},i),Ne(l[e].target,{"ui-drop":e}),l[e].data=r,zt.menu.set(e,n)},zt.menu.set=function(e,t){var l,s,n=zt.tools[e]||{},r=n.target,i=n.data;return r?(E(t)?Ne(r,on,t[1]||""):(Ne(r,on,t),t=i[t]&&i[t].text||t),E(t)?(s=t[0],s=De(s,"<")?s:zt.i(s,n.i),t=O(t[1])?t[1]:0,t=t&&i[t]&&i[t].text||t,t=s+(0!==t?"<span>"+(E(t)?t[1]||t:t)+"</span>":"")):s=zt.i(e,n.i),(l=vt("."+Mt+"-text",r)[0])?(nt(r,"text"),ft(l,t)):(it(r,"text"),ft(r,s)),o):o},zt.bubble=function(){zt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===Ie(e)&&(t="default",n=e[0]),X=Ge(t),ct(Gt,0),Tt(D,st(Gt,!1,{"class":Mt+"-bubble "+X})),w(n)?n(Gt):st(Gt,n),zt.bubble.fit(),R=[o,Gt],He("enter.bubble."+t,R),He("enter.bubble",R),o},zt.bubble.fit=function(e){J=o.$(1),t=Ve(Wt),N=u(Wt,"line-height");var n="border-",r="-width";X=J.caret[0].x+t.l-Wt.scrollLeft,V=J.caret[1].y+t.t+N-Wt.scrollTop,j=u(Nt,[n+"top"+r,n+"bottom"+r,n+"left"+r,n+"right"+r]);var i=et(Nt),l=et(Gt),s=j[0]+j[1],a=j[2]+j[3];return E(e)?(O(e[0])&&(X=e[0]),O(e[1])&&(V=e[1])):(X=p(X,t.l,t.l+i.w-l.w-a),V=p(V,t.t,t.t+i.h-l.h-s)),u(Gt,{left:X+Oe,top:V+Oe,visibility:"visible"}),R=[o,Gt],He("fit.bubble",R),He("fit",R),o},zt.panel.exit=function(e){return zt.exit(e,"panel")},zt.overlay.exit=function(e){return zt.exit(e,"overlay")},zt.modal.exit=function(e){return zt.exit(e,"modal")},zt.drop.exit=function(e){return zt.exit(e,"drop")},zt.bubble.exit=function(e){return zt.exit(e,"bubble")},zt.tool=function(e,t,n){var r=zt.tools;return Y="",W=O(r[e])?"update":"create","|"!==e&&(M.tools=Se(M.tools||"").filter(function(t,n){return t===e?(Y=n,!1):!0})),t===!1?(delete r[e],W="destroy"):("|"===e?(n=t,t={}):(w(t)&&(t={click:t}),r[e]=h(r[e]||{},t),O(n)||""===Y||(n=Y)),T(n)?M.tools.splice(n,0,e):M.tools.push(e)),He(W+".tool."+e,[o,r[e]]),cn(),o},zt.separator=function(e,t){return zt.tool("|",e!==!1?{attributes:e||{}}:!1,t)},zt.key=function(e,t){var n=zt.keys;return W=O(n[e])?"update":"create",t===!1?(delete n[e],W="destroy"):n[e]=t,He(W+".key."+e,[o,n[e]]),un(),o},zt.key.set=function(e){I[e]=1},zt.key.reset=function(e){e?delete I[e]:I={}},zt.tools={"|":{},undo:{click:function(e,t){return t.undo(),!1}},redo:{click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(xe),!1},outdent:function(e,t){return t.outdent(xe),!1}},zt.keys={"control+y":"redo","control+z":"undo",escape:function(e,t){return G=":not([tabindex]):not([disabled])",(J=vt("input"+G+",button"+G+",select"+G+",textarea"+G+",a[href]"+G+",[contenteditable]"+G+',[tabindex]:not([tabindex="-1"])',f,0))&&-1!==(V=J.indexOf(Wt))?((J[V+1]||f).focus(),!1):void 0},"alternate+f10":function(e,t){return vt("a",Yt)[0].focus(),!1},tab:ke?"indent":0,"shift+tab":ke?"outdent":0},zt.el={container:Ut,header:Bt,body:Nt,footer:At,panel:Kt,overlay:Pt,modal:Zt,drop:Qt,bubble:Gt},o.config=M,h(TE._,{time:function(e){var t=new Date(O(e)?e:Date.now()),n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),l=t.getHours(),s=t.getMinutes(),a=t.getSeconds(),f=t.getMilliseconds();return 10>r&&(r="0"+r),10>i&&(i="0"+i),10>l&&(l="0"+l),10>s&&(s="0"+s),10>a&&(a="0"+a),10>f&&(f="0"+f),[""+n,""+r,""+i,""+l,""+s,""+a,""+f]},replace:Ze,format:Qe,dom:{set:Tt,reset:Et,get:vt,id:at,copy:qt,replace:Ot,classes:{set:nt,reset:it,toggle:lt,get:rt},attributes:{set:Ce,reset:Be,get:Ue},data:{set:Ne,reset:Ye,get:Ae},is:$t,offset:Ve,pointer:Je,size:et,content:{set:ft,reset:ct,get:ot},closest:tt,parent:pt,children:dt,closest:ht,next:gt,previous:mt,index:bt,before:yt,after:xt,prepend:_t,append:wt},el:st,events:{set:Xe,reset:Ke,fire:Pe,x:We}}),h(o._,TE._),h(o._,{hooks:{set:je,reset:Fe,fire:He}}),o.create()},function(e,t){var n=TE,r=t.head,i="innerHTML",l="createElement",s="appendChild";n.plugs={},n.plug=function(e,i,a){var f=/\.css$/i.test(e),o=t[l](f?"link":"script");return f?(o.href=e,o.rel="stylesheet"):o.src=e,n.plugs[e]=o,(a||r)[s](o),n},n.css=function(e,a,f){var o=t[l]("style");return o[i]=e,a&&(o.id=a),(f||r)[s](o),n},n.js=function(e,a,f){var o=t[l]("script");return o[i]=e,a&&(o.id=a),(f||r)[s](o),n}}(window,document);